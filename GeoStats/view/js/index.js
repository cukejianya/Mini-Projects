!function t(e,n,r){function o(i,c){if(!n[i]){if(!e[i]){var u="function"==typeof require&&require;if(!c&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var s=n[i]={exports:{}};e[i][0].call(s.exports,function(t){var n=e[i][1][t];return o(n?n:t)},s,s.exports,t,e,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(t,e,n){function r(){s=!1,c.length?l=c.concat(l):f=-1,l.length&&o()}function o(){if(!s){var t=setTimeout(r);s=!0;for(var e=l.length;e;){for(c=l,l=[];++f<e;)c&&c[f].run();f=-1,e=l.length}c=null,s=!1,clearTimeout(t)}}function a(t,e){this.fun=t,this.array=e}function i(){}var c,u=e.exports={},l=[],s=!1,f=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new a(t,e)),1!==l.length||s||setTimeout(o,0)},a.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],2:[function(t,e,n){(function(t){!function(n){"use strict";function r(t){p(function(){throw t})}function o(t){return this.then(t,n)}function a(t){return this.then(n,t)}function i(t,e){return this.then(function(e){return g(t)?t.apply(null,h(e)?e:[e]):T.onlyFuncs?e:t},e||n)}function c(t){function e(){t()}return this.then(e,e),this}function u(t){return this.then(function(e){return g(t)?t.apply(null,h(e)?e.splice(0,0,void 0)&&e:[void 0,e]):T.onlyFuncs?e:t},function(e){return t(e)})}function l(t){return this.then(n,t?function(e){throw t(e),e}:r)}function s(t,e){var n=v(t);if(1===n.length&&h(n[0])){if(!n[0].length)return T.fulfilled([]);n=n[0]}var r=[],o=T(),a=n.length;if(a)for(var i=function(t){n[t]=T.promisify(n[t]),n[t].then(function(i){r[t]=e?n[t]:i,--a||o.resolve(r)},function(i){e?(r[t]=n[t],--a||o.resolve(r)):o.reject(i)})},c=0,u=a;u>c;c++)i(c);else o.resolve(r);return o.promise}function f(t,e){return t.then(g(e)?e:function(){return e})}function d(t){var e=v(t);1===e.length&&h(e[0])&&(e=e[0]);for(var n=T(),r=0,o=e.length,a=T.resolved();o>r;r++)a=f(a,e[r]);return n.resolve(a),n.promise}var p,g=function(t){return"function"==typeof t},h=function(t){return Array.isArray?Array.isArray(t):t instanceof Array},y=function(t){return!(!t||!(typeof t).match(/function|object/))},m=function(t){return t===!1||t===n||null===t},v=function(t,e){return[].slice.call(t,e)},w="undefined",x=typeof TypeError===w?Error:TypeError;if(typeof t!==w&&t.nextTick)p=t.nextTick;else if(typeof MessageChannel!==w){var b=new MessageChannel,A=[];b.port1.onmessage=function(){A.length&&A.shift()()},p=function(t){A.push(t),b.port2.postMessage(0)}}else p=function(t){setTimeout(t,0)};var T=function(t){function e(){if(0!==h){var t,e=v,n=0,r=e.length,o=~h?0:1;for(v=[];r>n;n++)(t=e[n][o])&&t(f)}}function r(t){function n(t){return function(e){return o?void 0:(o=!0,t(e))}}var o=!1;if(h)return this;try{var a=y(t)&&t.then;if(g(a)){if(t===w)throw new x("Promise can't resolve itself");return a.call(t,n(r),n(s)),this}}catch(i){return n(s)(i),this}return d(function(){f=t,h=1,e()}),this}function s(t){return h||d(function(){try{throw t}catch(n){f=n}h=-1,e()}),this}var f,d=(n!==t?t:T.alwaysAsync)?p:function(t){t()},h=0,v=[],w={then:function(t,n){var r=T();return v.push([function(e){try{m(t)?r.resolve(e):r.resolve(g(t)?t(e):T.onlyFuncs?e:t)}catch(n){r.reject(n)}},function(t){if((m(n)||!g(n)&&T.onlyFuncs)&&r.reject(t),n)try{r.resolve(g(n)?n(t):n)}catch(e){r.reject(e)}}]),0!==h&&d(e),r.promise},success:o,error:a,otherwise:a,apply:i,spread:i,ensure:c,nodify:u,rethrow:l,isPending:function(){return 0===h},getStatus:function(){return h}};return w.toSource=w.toString=w.valueOf=function(){return f===n?this:f},{promise:w,resolve:r,fulfill:r,reject:s}};if(T.deferred=T.defer=T,T.nextTick=p,T.alwaysAsync=!0,T.onlyFuncs=!0,T.resolved=T.fulfilled=function(t){return T(!0).resolve(t).promise},T.rejected=function(t){return T(!0).reject(t).promise},T.wait=function(t){var e=T();return setTimeout(e.resolve,t||0),e.promise},T.delay=function(t,e){var n=T();return setTimeout(function(){try{n.resolve(g(t)?t.apply(null):t)}catch(e){n.reject(e)}},e||0),n.promise},T.promisify=function(t){return t&&g(t.then)?t:T.resolved(t)},T.all=function(){return s(arguments,!1)},T.resolveAll=function(){return s(arguments,!0)},T.sequence=function(){return d(arguments)},T.nodeCapsule=function(t,e){return e||(e=t,t=void 0),function(){var n=T(),r=v(arguments);r.push(function(t,e){t?n.reject(t):n.resolve(arguments.length>2?v(arguments,1):e)});try{e.apply(t,r)}catch(o){n.reject(o)}return n.promise}},"function"==typeof define&&define.amd)define("D.js",[],function(){return T});else if(typeof e!==w&&e.exports)e.exports=T;else if(typeof window!==w){var j=window.D;T.noConflict=function(){return window.D=j,T},window.D=T}}()}).call(this,t("_process"))},{_process:1}],3:[function(t,e,n){function r(t){var e=o();return $.ajax({type:"POST",url:"/coords/",data:t,success:function(t){t=JSON.parse(t),e.resolve(t)},error:function(t,e,n){console.log("text status "+e+", err "+n)}}),e.promise}var o=t("d.js");e.exports=r},{"d.js":2}],4:[function(t,e,n){function r(t,e,n){var r=Math.pow(2,a.getZoom()),o=(new google.maps.LatLng(a.getBounds().getNorthEast().lat(),a.getBounds().getSouthWest().lng()),a.getProjection().fromLatLngToPoint(t)),i=new google.maps.Point(e/r||0,n/r||0),c=new google.maps.Point(o.x-i.x,o.y+i.y),u=a.getProjection().fromPointToLatLng(c);a.setCenter(u)}function o(t){a=new google.maps.Map(document.getElementById("map-canvas"),{center:{lat:41.850033,lng:-87.6500523},zoom:4});var e=document.getElementById("searchTextField"),n={componentRestrictions:{country:"us"}};autocomplete=new google.maps.places.Autocomplete(e,n);var o=new google.maps.InfoWindow({maxWidth:700}),i=new google.maps.Marker({map:a});i.addListener("click",function(t){o.open(a,i)}),autocomplete.addListener("place_changed",function(){o.close();var e=autocomplete.getPlace();if(e.geometry){console.log("place:",e),console.log(e.address_components);var n={lat:e.geometry.location.lat(),lng:e.geometry.location.lng(),type:e.address_components[0].types[0]};console.log(n.type,"Place Geometry",e.geometry.location),e.geometry.viewport?a.fitBounds(e.geometry.viewport):(r(e.geometry.location,0,-700),a.setZoom(17)),i.setPlace({placeId:e.place_id,location:e.geometry.location}),i.setVisible(!0),o.setContent("<div><strong>"+e.name+"</strong><br>"+e.formatted_address+"<br><br><strong>Race</strong><br><div class='race' style='height:350; width:900 ; display: inline-block;'><table class='left'></table></div><br><br><strong>Gender and Age</strong><br><div class='genderAge' style='height:350; display: inline-block;'><table class='left'></table></div></div>"),o.open(a,i),t(n)}}),console.log(o)}var a;e.exports=o},{}],5:[function(t,e,n){function r(t){var e=d3.select(".total"),n=d3.select(".race"),r=d3.select(".genderAge"),a=t.race.total,i=t.race,u=t.femaleAge,l=t.maleAge;console.log(l),c?o():c=!0,s(e,a),f(n,i),d(r,[l,u])}function o(){d3.select(".total").select("h3").remove(),d3.select(".race").select("table").selectAll("tr").remove(),d3.select(".race").select("svg").remove(),d3.select(".genderAge").select("svg").remove()}function a(t){l(t).then(function(t){console.log(t),i=r.bind(null,t),r(t)})}var i,c,u=t("./initMap"),l=t("./ajax"),s=t("./plotTotal"),f=t("./plotRace"),d=t("./plotGenderAge");$(window).resize(function(){i()}),console.log(typeof u),$(document).ready(function(){u(a)})},{"./ajax":3,"./initMap":4,"./plotGenderAge":6,"./plotRace":7,"./plotTotal":8}],6:[function(t,e,n){function r(t,e){function n(t,e){"stack"===this.type?(e(),this.type="group"):(t(),this.type="stack")}function r(t,e,n,r,o,a){t.domain([0,e]),r.transition().duration(500).delay(function(t,e){return 10*e}).attr("x",function(t,e,r){return n(a[t.x])+n.rangeBand()/i*r}).attr("width",n.rangeBand()/i).transition().attr("y",function(e){return t(e.y)}).attr("height",function(e){return o-t(e.y)})}function o(t,e,n,r,o){t.domain([0,e]),r.transition().duration(500).delay(function(t,e){return 10*e}).attr("y",function(e){return t(e.y0+e.y)}).attr("height",function(e){return t(e.y0)-t(e.y0+e.y)}).transition().attr("x",function(t){return n(o[t.x])}).attr("width",n.rangeBand())}var a=Object.keys(e[0]);a.shift(),console.log(a),console.log("Age",e[0][a[3]]),console.log("MaleTotal",e[0].total,e[0].total);var i=2,c=d3.layout.stack(),u=c(d3.range(i).map(function(t){return a.map(function(n,r){return{x:r,y:Math.max(0,parseInt(e[t][n]))}})})),l=d3.max(u,function(t){return d3.max(t,function(t){return t.y})}),s=d3.max(u,function(t){return d3.max(t,function(t){return t.y0+t.y})}),f=(t.node().parentElement,d3.scale.linear().domain([0,i-1]).range(["#aad","#556"])),d=a.slice();d.unshift("header"),d.push("Total");var p=t.select("table").selectAll("tr").data(d),g=p.enter().append("tr"),h=g.selectAll("td").data(function(t,n){return n?"Total"===t?[t,e[0].total,e[1].total,e[0].total+e[1].total]:[t,e[0][t],e[1][t],e[0][t]+e[1][t]]:["Ages","Males","Females","Total"]});h.enter().append("td").text(function(t,e){return console.log(t),t}),t.node().type="stack",console.log(t,t.node().type);var y={top:40,right:40,bottom:70,left:10},m=200-y.left-y.right,v=200-y.top-y.bottom,w=d3.scale.ordinal().domain(a).rangeRoundBands([0,m],.08),x=d3.scale.linear().domain([0,s]).range([v,0]),b=d3.svg.axis().scale(w).tickSize(1).tickPadding(6).orient("bottom"),A=t.append("svg").attr("width",m+y.left+y.right).attr("height",v+y.top+y.bottom).append("g").attr("transform","translate("+y.left+","+y.top+")"),T=A.selectAll(".layer").data(u).enter().append("g").attr("class","layer").style("fill",function(t,e){return f(e)}),j=T.selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(t){return console.log(w,w(a[t.x]),t.x,t),w(a[t.x])}).attr("y",v).attr("width",w.rangeBand()).attr("height",0);j.transition().delay(function(t,e){return 10*e}).attr("y",function(t){return x(t.y0+t.y)}).attr("height",function(t){return x(t.y0)-x(t.y0+t.y)}),A.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").call(b).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start");setTimeout(function(){d3.select('input[value="grouped"]').property("checked",!0).each(n)},2e3);t.on("click",n.bind(t.node(),o.bind(null,x,s,w,j,a),r.bind(null,x,l,w,j,v,a)))}e.exports=r},{}],7:[function(t,e,n){function r(t,e){var n=Object.keys(e).splice(1),r=n.filter(function(t){return"total"!==t}).map(function(t){return e[t]}),o=d3.scale.category20(),a=t.select("table").selectAll("tr").data(n),i=a.enter().append("tr");i.append("td").text("HH").style("background",function(t,e){return o(e)}).style("color",function(t,e){return o(e)}),i.append("td").text(function(t,n){var r=t.split(" ").map(function(t){return t[0].toUpperCase()+t.slice(1)}).join(" ");return" "+r+": "+e[t]});var c=(t.node().parentElement,175),u=175,l=u/2-30,s=l/3,f=d3.svg.arc().innerRadius(s).outerRadius(l),d=d3.layout.pie(),p=d3.ease("cubic-in-out"),g=2500,h=t.append("svg").attr("width",c).attr("height",u).append("g").attr("transform","translate("+c/2+","+u/2+")"),y=h.selectAll("path").data(r).enter().append("path").style("fill",function(t,e){return o(e)});d3.timer(function(t){var e=p(1-2*Math.abs(t%g/g-.5)),n=d.padAngle(.06*e)(r);y.data(n).attr("d",f)})}e.exports=r},{}],8:[function(t,e,n){function r(t,e){t.append("h3").text(function(){return"Total Population: "+e})}e.exports=r},{}]},{},[5]);
//# sourceMappingURL=index.js.map
