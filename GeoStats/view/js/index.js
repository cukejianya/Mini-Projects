!function t(e,n,r){function o(a,u){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return o(n?n:t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){function r(){l=!1,u.length?s=u.concat(s):f=-1,s.length&&o()}function o(){if(!l){var t=setTimeout(r);l=!0;for(var e=s.length;e;){for(u=s,s=[];++f<e;)u&&u[f].run();f=-1,e=s.length}u=null,l=!1,clearTimeout(t)}}function i(t,e){this.fun=t,this.array=e}function a(){}var u,c=e.exports={},s=[],l=!1,f=-1;c.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new i(t,e)),1!==s.length||l||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=a,c.addListener=a,c.once=a,c.off=a,c.removeListener=a,c.removeAllListeners=a,c.emit=a,c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],2:[function(t,e,n){(function(t){!function(n){"use strict";function r(t){p(function(){throw t})}function o(t){return this.then(t,n)}function i(t){return this.then(n,t)}function a(t,e){return this.then(function(e){return h(t)?t.apply(null,g(e)?e:[e]):j.onlyFuncs?e:t},e||n)}function u(t){function e(){t()}return this.then(e,e),this}function c(t){return this.then(function(e){return h(t)?t.apply(null,g(e)?e.splice(0,0,void 0)&&e:[void 0,e]):j.onlyFuncs?e:t},function(e){return t(e)})}function s(t){return this.then(n,t?function(e){throw t(e),e}:r)}function l(t,e){var n=v(t);if(1===n.length&&g(n[0])){if(!n[0].length)return j.fulfilled([]);n=n[0]}var r=[],o=j(),i=n.length;if(i)for(var a=function(t){n[t]=j.promisify(n[t]),n[t].then(function(a){r[t]=e?n[t]:a,--i||o.resolve(r)},function(a){e?(r[t]=n[t],--i||o.resolve(r)):o.reject(a)})},u=0,c=i;c>u;u++)a(u);else o.resolve(r);return o.promise}function f(t,e){return t.then(h(e)?e:function(){return e})}function d(t){var e=v(t);1===e.length&&g(e[0])&&(e=e[0]);for(var n=j(),r=0,o=e.length,i=j.resolved();o>r;r++)i=f(i,e[r]);return n.resolve(i),n.promise}var p,h=function(t){return"function"==typeof t},g=function(t){return Array.isArray?Array.isArray(t):t instanceof Array},y=function(t){return!(!t||!(typeof t).match(/function|object/))},m=function(t){return t===!1||t===n||null===t},v=function(t,e){return[].slice.call(t,e)},w="undefined",x=typeof TypeError===w?Error:TypeError;if(typeof t!==w&&t.nextTick)p=t.nextTick;else if(typeof MessageChannel!==w){var A=new MessageChannel,b=[];A.port1.onmessage=function(){b.length&&b.shift()()},p=function(t){b.push(t),A.port2.postMessage(0)}}else p=function(t){setTimeout(t,0)};var j=function(t){function e(){if(0!==g){var t,e=v,n=0,r=e.length,o=~g?0:1;for(v=[];r>n;n++)(t=e[n][o])&&t(f)}}function r(t){function n(t){return function(e){return o?void 0:(o=!0,t(e))}}var o=!1;if(g)return this;try{var i=y(t)&&t.then;if(h(i)){if(t===w)throw new x("Promise can't resolve itself");return i.call(t,n(r),n(l)),this}}catch(a){return n(l)(a),this}return d(function(){f=t,g=1,e()}),this}function l(t){return g||d(function(){try{throw t}catch(n){f=n}g=-1,e()}),this}var f,d=(n!==t?t:j.alwaysAsync)?p:function(t){t()},g=0,v=[],w={then:function(t,n){var r=j();return v.push([function(e){try{m(t)?r.resolve(e):r.resolve(h(t)?t(e):j.onlyFuncs?e:t)}catch(n){r.reject(n)}},function(t){if((m(n)||!h(n)&&j.onlyFuncs)&&r.reject(t),n)try{r.resolve(h(n)?n(t):n)}catch(e){r.reject(e)}}]),0!==g&&d(e),r.promise},success:o,error:i,otherwise:i,apply:a,spread:a,ensure:u,nodify:c,rethrow:s,isPending:function(){return 0===g},getStatus:function(){return g}};return w.toSource=w.toString=w.valueOf=function(){return f===n?this:f},{promise:w,resolve:r,fulfill:r,reject:l}};if(j.deferred=j.defer=j,j.nextTick=p,j.alwaysAsync=!0,j.onlyFuncs=!0,j.resolved=j.fulfilled=function(t){return j(!0).resolve(t).promise},j.rejected=function(t){return j(!0).reject(t).promise},j.wait=function(t){var e=j();return setTimeout(e.resolve,t||0),e.promise},j.delay=function(t,e){var n=j();return setTimeout(function(){try{n.resolve(h(t)?t.apply(null):t)}catch(e){n.reject(e)}},e||0),n.promise},j.promisify=function(t){return t&&h(t.then)?t:j.resolved(t)},j.all=function(){return l(arguments,!1)},j.resolveAll=function(){return l(arguments,!0)},j.sequence=function(){return d(arguments)},j.nodeCapsule=function(t,e){return e||(e=t,t=void 0),function(){var n=j(),r=v(arguments);r.push(function(t,e){t?n.reject(t):n.resolve(arguments.length>2?v(arguments,1):e)});try{e.apply(t,r)}catch(o){n.reject(o)}return n.promise}},"function"==typeof define&&define.amd)define("D.js",[],function(){return j});else if(typeof e!==w&&e.exports)e.exports=j;else if(typeof window!==w){var T=window.D;j.noConflict=function(){return window.D=T,j},window.D=j}}()}).call(this,t("_process"))},{_process:1}],3:[function(t,e,n){function r(t){var e=o();return $.ajax({type:"POST",url:"/coords/",data:t,success:function(t){t=JSON.parse(t),e.resolve(t)},error:function(t,e,n){alert("text status "+e+", err "+n)}}),e.promise}var o=t("d.js");e.exports=r},{"d.js":2}],4:[function(t,e,n){function r(){var t=i();o=new google.maps.Map(document.getElementById("map-canvas"),{center:{lat:41.850033,lng:-87.6500523},zoom:4});var e=document.getElementById("searchTextField"),n={componentRestrictions:{country:"us"}};autocomplete=new google.maps.places.Autocomplete(e,n);var r=new google.maps.InfoWindow,a=new google.maps.Marker({map:o});return a.addListener("click",function(){r.open(o,a)}),autocomplete.addListener("place_changed",function(){r.close();var e=autocomplete.getPlace();if(e.geometry){console.log(e.address_components);var n={lat:e.geometry.location.lat(),lng:e.geometry.location.lng(),type:e.address_components[0].types[0],place:e.address_components[0].long_name};console.log(n.type),t.resolve(n),e.geometry.viewport?o.fitBounds(e.geometry.viewport):(o.setCenter(e.geometry.location),o.setZoom(17)),a.setPlace({placeId:e.place_id,location:e.geometry.location}),a.setVisible(!0),r.setContent("<div><strong>"+e.name+"</strong><br>Place ID: "+e.place_id+"<br>"+e.formatted_address),r.open(o,a)}}),t.promise}var o,i=t("d.js");e.exports=r},{"d.js":2}],5:[function(t,e,n){function r(t){var e=d3.select(".total"),n=d3.select(".race"),r=d3.select(".genderAge"),i=t.race.total,u=t.race,c=t.femaleAge,d=t.maleAge;console.log(d),a?o():a=!0,s(e,i),l(n,u),f(r,[d,c])}function o(){d3.select(".total").select("h3").remove(),d3.select(".race").select("table").selectAll("tr").remove(),d3.select(".race").select("svg").remove(),d3.select(".genderAge").select("svg").remove()}var i,a,u=t("./initMap"),c=t("./ajax"),s=t("./plotTotal"),l=t("./plotRace"),f=t("./plotGenderAge");$(window).resize(function(){i()}),console.log(typeof u),$(document).ready(function(){u().then(c).then(function(t){console.log(t),i=r.bind(null,t),r(t)})})},{"./ajax":3,"./initMap":4,"./plotGenderAge":6,"./plotRace":7,"./plotTotal":8}],6:[function(t,e,n){function r(t,e){function n(t,e){"stack"===this.type?(e(),this.type="group"):(t(),this.type="stack")}function r(t,e,n,r,o,i){t.domain([0,e]),r.transition().duration(500).delay(function(t,e){return 10*e}).attr("x",function(t,e,r){return n(i[t.x])+n.rangeBand()/a*r}).attr("width",n.rangeBand()/a).transition().attr("y",function(e){return t(e.y)}).attr("height",function(e){return o-t(e.y)})}function o(t,e,n,r,o){t.domain([0,e]),r.transition().duration(500).delay(function(t,e){return 10*e}).attr("y",function(e){return t(e.y0+e.y)}).attr("height",function(e){return t(e.y0)-t(e.y0+e.y)}).transition().attr("x",function(t){return n(o[t.x])}).attr("width",n.rangeBand())}var i=Object.keys(e[0]);i.shift(),console.log(i);var a=2,u=d3.layout.stack(),c=u(d3.range(a).map(function(t){return i.map(function(n,r){return{x:r,y:Math.max(0,parseInt(e[t][n]))}})})),s=d3.max(c,function(t){return d3.max(t,function(t){return t.y})}),l=d3.max(c,function(t){return d3.max(t,function(t){return t.y0+t.y})}),f=t.node().parentElement;t.node().type="stack",console.log(t,t.node().type);var d={top:40,right:40,bottom:70,left:10},p=f.offsetWidth-d.left-d.right,h=f.offsetWidth-d.top-d.bottom,g=d3.scale.ordinal().domain(i).rangeRoundBands([0,p],.08),y=d3.scale.linear().domain([0,l]).range([h,0]),m=d3.scale.linear().domain([0,a-1]).range(["#aad","#556"]),v=d3.svg.axis().scale(g).tickSize(1).tickPadding(6).orient("bottom"),w=t.append("svg").attr("width",p+d.left+d.right).attr("height",h+d.top+d.bottom).append("g").attr("transform","translate("+d.left+","+d.top+")"),x=w.selectAll(".layer").data(c).enter().append("g").attr("class","layer").style("fill",function(t,e){return m(e)}),A=x.selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(t){return console.log(g,g(i[t.x]),t.x,t),g(i[t.x])}).attr("y",h).attr("width",g.rangeBand()).attr("height",0);A.transition().delay(function(t,e){return 10*e}).attr("y",function(t){return y(t.y0+t.y)}).attr("height",function(t){return y(t.y0)-y(t.y0+t.y)}),w.append("g").attr("class","x axis").attr("transform","translate(0,"+h+")").call(v).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start");setTimeout(function(){d3.select('input[value="grouped"]').property("checked",!0).each(n)},2e3);t.on("click",n.bind(t.node(),o.bind(null,y,l,g,A,i),r.bind(null,y,s,g,A,h,i)))}e.exports=r},{}],7:[function(t,e,n){function r(t,e){var n=Object.keys(e).splice(1),r=n.filter(function(t){return"total"!==t}).map(function(t){return e[t]}),o=d3.scale.category20(),i=t.select("table").selectAll("tr").data(n),a=i.enter().append("tr");a.append("td").text("HH").style("background",function(t,e){return o(e)}).style("color",function(t,e){return o(e)}),a.append("td").text(function(t,n){var r=t.split(" ").map(function(t){return t[0].toUpperCase()+t.slice(1)}).join(" ");return" "+r+": "+e[t]});var u=t.node().parentElement,c=u.offsetWidth-25,s=u.offsetWidth-25,l=s/2-30,f=l/3,d=d3.svg.arc().innerRadius(f).outerRadius(l),p=d3.layout.pie(),h=d3.ease("cubic-in-out"),g=2500,y=t.append("svg").attr("width",c).attr("height",s).append("g").attr("transform","translate("+c/2+","+s/2+")"),m=y.selectAll("path").data(r).enter().append("path").style("fill",function(t,e){return o(e)});d3.timer(function(t){var e=h(1-2*Math.abs(t%g/g-.5)),n=p.padAngle(.06*e)(r);m.data(n).attr("d",d)})}e.exports=r},{}],8:[function(t,e,n){function r(t,e){t.append("h3").text(function(){return"Total Population: "+e})}e.exports=r},{}]},{},[5]);
//# sourceMappingURL=index.js.map
